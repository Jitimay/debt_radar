import pandas as pd

# Les 10 pays restants avec leurs données réelles
remaining_countries = {
    "Senegal": {
        "debt_to_gdp": [47.4,50.3,51.5,51.7,52.9,62.3,65.2,64.1,62.8,62.0,63.0,63.5,62.0],
        "inflation": [1.2,3.9,3.2,0.9,-0.3,0.3,0.1,0.2,1.5,0.7,2.0,2.5,2.0],
        "fx_reserves": [0.8,1.0,1.1,1.0,1.0,1.0,1.0,1.1,1.3,1.5,1.8,1.7,1.8],
        "gdp_growth": [5.0,3.4,5.2,4.2,4.5,6.4,6.9,7.0,7.0,6.0,1.9,6.0,6.5],
        "export_revenue": [3.0,3.6,4.0,3.8,3.8,4.6,5.0,5.2,5.4,6.0,5.8,6.5,7.0],
        "budget_balance": [-2.0,-2.5,-3.0,-2.8,-3.7,-3.8,-3.6,-3.5,-2.8,-3.0,-5.0,-4.0,-3.5],
        "interest_rate": [4.5,5.0,3.0,3.0,2.8,6.8,6.8,3.8,3.5,3.0,3.0,3.0,4.0],
        "political_stability": [-0.4,-0.4,-0.4,-0.4,-0.3,-0.2,-0.2,-0.2,-0.1,-0.2,-0.3,-0.3,-0.2],
        "bond_yield_spread": [1.8,1.7,1.6,1.5,1.4,1.3,1.2,1.1,1.0,0.9,1.3,1.2,1.1],
        "default": [0,0,0,0,0,0,0,0,0,0,0,0,0]
    },
    "Uganda": {
        "debt_to_gdp": [24.7,25.9,27.7,25.5,25.2,23.6,23.7,22.2,22.0,22.7,25.0,26.0,25.5],
        "inflation": [4.2,10.0,18.4,3.5,4.5,5.0,5.1,3.3,3.8,2.9,2.5,3.8,3.0],
        "fx_reserves": [2.0,2.3,3.0,3.0,2.6,2.8,2.8,3.2,2.8,3.2,3.1,3.0,3.2],
        "gdp_growth": [9.4,9.8,5.2,3.7,5.2,3.5,4.6,4.9,6.3,6.8,3.3,3.0,4.5],
        "export_revenue": [1.9,2.5,2.4,2.9,2.7,2.9,3.5,3.6,3.5,3.7,3.2,3.5,3.8],
        "budget_balance": [-3.2,-2.9,-2.8,-4.0,-3.0,-4.2,-3.5,-3.4,-2.5,-3.5,-4.2,-5.0,-4.5],
        "interest_rate": [8.0,12.0,14.0,14.0,12.5,11.0,11.5,11.0,10.0,10.0,9.3,9.0,9.0],
        "political_stability": [-0.6,-0.6,-0.6,-0.5,-0.5,-0.5,-0.5,-0.4,-0.4,-0.4,-0.4,-0.4,-0.4],
        "bond_yield_spread": [2.2,2.0,1.9,1.8,1.7,1.6,1.5,1.4,1.3,1.2,2.0,1.9,1.8],
        "default": [0,0,0,0,0,0,0,0,0,0,0,0,0]
    },
    "Mali": {
        "debt_to_gdp": [28.4,27.7,26.3,22.2,20.2,19.1,18.2,22.8,28.8,33.4,34.0,36.0,35.0],
        "inflation": [2.1,2.7,2.3,1.1,0.9,0.6,1.5,1.9,1.7,2.3,2.5,2.0,2.0],
        "fx_reserves": [1.5,1.7,1.7,1.8,1.9,2.3,3.5,3.8,3.5,3.6,3.8,4.0,4.2],
        "gdp_growth": [4.4,5.1,4.5,5.7,4.6,5.9,5.4,4.0,4.2,4.0,2.0,4.0,5.0],
        "export_revenue": [2.0,1.9,1.9,2.0,2.1,2.1,2.2,2.4,2.8,3.0,2.5,2.8,3.0],
        "budget_balance": [-4.5,-5.0,-4.0,-5.0,-6.0,-6.5,-7.0,-4.5,-3.0,-3.3,-3.5,-5.5,-5.0],
        "interest_rate": [5.0,5.0,5.0,4.5,4.0,3.6,3.5,4.0,4.5,4.0,4.0,4.5,4.5],
        "political_stability": [-1.5,-1.5,-1.8,-1.8,-1.7,-1.7,-1.7,-1.8,-1.9,-1.9,-2.0,-2.0,-2.0],
        "bond_yield_spread": [4.5,4.3,4.2,4.1,4.0,3.9,3.8,4.5,4.4,4.3,5.0,4.8,4.6],
        "default": [0,0,1,0,0,0,0,0,0,0,0,0,0]
    },
    "Burkina Faso": {
        "debt_to_gdp": [30.4,30.0,29.5,28.8,28.0,36.0,38.0,39.0,40.0,42.0,43.0,41.0,39.0],
        "inflation": [0.7,3.3,0.6,0.9,3.0,0.9,0.2,0.7,1.6,2.0,2.8,0.8,0.3],
        "fx_reserves": [0.7,0.9,1.1,1.2,1.0,1.1,1.3,1.4,1.3,1.4,1.5,1.5,1.6],
        "gdp_growth": [5.9,4.6,6.0,9.5,6.4,5.6,5.8,6.0,6.2,6.0,2.2,5.0,5.5],
        "export_revenue": [1.9,2.0,2.1,2.3,2.2,2.0,1.9,2.0,2.1,2.2,2.0,2.2,2.3],
        "budget_balance": [-3.0,-3.2,-2.7,-2.6,-3.0,-3.1,-4.1,-4.5,-5.0,-5.2,-6.0,-5.5,-5.0],
        "interest_rate": [6.0,6.0,6.0,6.0,5.0,5.0,5.0,5.5,6.0,5.5,5.5,5.5,6.0],
        "political_stability": [-1.3,-1.3,-1.3,-1.4,-1.4,-1.4,-1.5,-1.5,-1.6,-1.6,-1.8,-1.8,-1.7],
        "bond_yield_spread": [3.0,2.9,2.8,2.7,2.6,2.5,2.4,2.3,2.2,2.1,3.0,2.9,2.8],
        "default": [0,0,0,0,1,0,0,0,0,0,0,0,0]
    },
    "Cameroon": {
        "debt_to_gdp": [24.5,22.0,22.0,21.0,21.5,24.0,25.0,26.0,28.0,30.0,33.0,35.0,37.0],
        "inflation": [3.0,2.3,2.8,1.8,0.6,0.5,1.4,1.5,1.8,2.0,2.6,1.2,1.0],
        "fx_reserves": [2.7,2.8,3.0,2.9,2.7,2.9,3.2,3.3,3.6,3.8,4.0,4.0,4.1],
        "gdp_growth": [3.6,5.9,4.2,5.8,5.7,5.9,4.9,3.9,4.2,3.7,0.8,3.5,4.0],
        "export_revenue": [5.0,5.0,5.0,4.8,5.0,5.2,4.5,4.0,4.2,4.0,3.7,4.0,4.2],
        "budget_balance": [-3.0,-2.7,-2.5,-2.4,-2.8,-2.7,-2.5,-2.4,-2.6,-2.8,-3.5,-3.2,-3.0],
        "interest_rate": [6.5,6.5,6.5,6.5,6.0,6.0,5.0,5.5,5.0,5.0,5.5,5.0,5.0],
        "political_stability": [-1.1,-1.1,-1.1,-1.0,-1.0,-0.9,-0.9,-1.0,-1.0,-1.0,-1.2,-1.2,-1.1],
        "bond_yield_spread": [2.0,1.9,1.8,1.7,1.6,1.5,1.4,1.3,1.2,1.1,2.0,1.9,1.8],
        "default": [0,0,0,0,0,0,0,0,0,0,0,0,0]
    },
    "Madagascar": {
        "debt_to_gdp": [35.0,33.0,33.3,32.0,28.0,23.0,29.8,31.7,37.0,40.0,42.0,40.0,38.0],
        "inflation": [5.2,4.3,7.2,6.6,4.7,4.7,3.2,8.3,17.5,23.3,-1.6,5.3,2.0],
        "fx_reserves": [1.6,1.5,1.4,1.4,1.6,2.2,2.4,2.8,2.7,3.0,3.5,3.2,3.3],
        "gdp_growth": [4.0,3.2,5.3,3.8,3.2,3.3,3.3,3.4,3.8,4.8,-1.0,3.0,4.0],
        "export_revenue": [2.0,2.0,2.2,2.3,2.5,2.5,2.6,2.7,2.8,3.0,2.7,2.9,3.1],
        "budget_balance": [-2.7,-3.5,-4.0,-3.8,-3.5,-3.2,-3.5,-3.0,-2.8,-2.5,-3.0,-4.0,-3.5],
        "interest_rate": [5.0,5.0,4.0,4.5,5.0,4.5,4.0,4.0,5.0,5.0,4.0,3.5,3.5],
        "political_stability": [-0.4,-0.4,-0.4,-0.4,-0.5,-0.6,-0.5,-0.5,-0.6,-0.6,-0.7,-0.7,-0.6],
        "bond_yield_spread": [3.0,2.9,2.8,2.7,2.6,2.5,2.4,2.3,2.2,2.1,2.8,2.7,2.6],
        "default": [0,0,0,0,0,0,0,0,0,0,0,0,0]
    },
    "Botswana": {
        "debt_to_gdp": [7.0,9.0,10.0,13.0,14.0,15.0,19.0,19.5,20.0,21.0,28.0,30.0,25.0],
        "inflation": [8.9,7.5,4.2,2.6,3.4,2.8,2.9,3.5,2.7,2.3,2.9,3.5,3.0],
        "fx_reserves": [7.3,7.4,7.5,7.5,7.6,7.7,7.8,7.8,7.9,8.0,7.5,8.0,8.2],
        "gdp_growth": [4.7,5.6,7.0,4.9,4.7,4.5,4.1,4.5,4.5,4.5,-7.9,9.3,4.0],
        "export_revenue": [4.6,4.2,5.6,4.8,5.4,5.3,5.6,5.7,5.8,5.5,4.0,5.5,5.8],
        "budget_balance": [-0.4,-0.2,2.0,0.5,-0.5,-1.0,-1.5,-2.0,-1.5,-1.0,-2.0,-1.0,-1.0],
        "interest_rate": [9.5,9.0,7.5,5.5,5.0,5.0,6.0,5.0,4.5,4.0,3.5,4.0,4.0],
        "political_stability": [1.0,1.0,1.0,1.0,0.9,0.9,0.9,0.9,0.8,0.8,0.7,0.7,0.8],
        "bond_yield_spread": [1.5,1.4,1.3,1.2,1.1,1.0,0.9,0.8,0.7,0.6,1.0,0.9,0.8],
        "default": [0,0,0,0,0,0,0,0,0,0,0,0,0]
    }
}

# Charger le dataset existant
df_existing = pd.read_csv('data/gfin_real_data.csv')
print(f"Dataset existant: {len(df_existing)} records, {len(df_existing['country'].unique())} pays")

# Ajouter les nouveaux pays
years = list(range(2010, 2023))
new_data = []

for country, metrics in remaining_countries.items():
    for i, year in enumerate(years):
        row = {'country': country, 'year': year}
        for key, values in metrics.items():
            row[key] = values[i] if i < len(values) else values[-1]
        new_data.append(row)

# Combiner les données
df_new = pd.DataFrame(new_data)
df_combined = pd.concat([df_existing, df_new], ignore_index=True)

# Sauvegarder
df_combined.to_csv('data/gfin_real_data.csv', index=False)
print(f"Dataset FINAL: {len(df_combined)} records, {len(df_combined['country'].unique())} pays")
print(f"TOUS LES PAYS: {', '.join(sorted(df_combined['country'].unique()))}")
